<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quran | المصحف الإلكتروني</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <style>
        :root {
            --primary: #059669;
            --primary-dark: #064e3b;
            --accent: #f59e0b;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background-color: #f8fafc;
            scroll-behavior: smooth;
        }

        .quran-font {
            font-family: 'Amiri', serif;
        }

        /* تخصيص شريط التمرير */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }

        .glass-nav {
            background: rgba(6, 78, 59, 0.95);
            backdrop-filter: blur(10px);
        }

        .active-tab {
            background-color: var(--accent);
            color: var(--primary-dark);
            font-weight: bold;
        }

        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        footer {
            background-color: #064e3b;
            color: white;
            padding: 2rem 1rem;
            text-align: center;
            margin-bottom: 120px; /* Space for the player */
            border-top: 4px solid #f59e0b;
        }
    </style>
</head>
<body class="text-slate-900">

    <!-- Header -->
    <header class="glass-nav text-white sticky top-0 z-50 shadow-2xl">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center gap-4">
                <div class="bg-white p-2 rounded-2xl shadow-lg transform -rotate-12">
                    <i class="fa-solid fa-book-quran text-3xl text-emerald-700"></i>
                </div>
                <div>
                    <h1 class="text-4xl font-black tracking-tighter text-amber-400">Quran</h1>
                    <p class="text-[10px] text-emerald-100 uppercase tracking-widest opacity-80">استماع وتلاوة ومصحف</p>
                </div>
            </div>

            <!-- Desktop Menu -->
            <nav class="hidden md:flex bg-emerald-900/50 p-1 rounded-full border border-emerald-700">
                <button onclick="switchSection('radios')" class="nav-btn px-8 py-2 rounded-full transition-all active-tab" data-target="radios">إذاعة</button>
                <button onclick="switchSection('reciters')" class="nav-btn px-8 py-2 rounded-full transition-all" data-target="reciters">القراء</button>
                <button onclick="switchSection('mushaf')" class="nav-btn px-8 py-2 rounded-full transition-all" data-target="mushaf">المصحف</button>
            </nav>

            <button onclick="toggleMobileMenu()" class="md:hidden text-2xl p-2"><i class="fa-solid fa-bars-staggered"></i></button>
        </div>

        <div id="mobileMenu" class="hidden md:hidden bg-emerald-950 p-6 border-t border-emerald-800">
            <div class="flex flex-col gap-4">
                <button onclick="switchSection('radios')" class="text-right py-3 border-b border-emerald-800">الإذاعة المباشرة</button>
                <button onclick="switchSection('reciters')" class="text-right py-3 border-b border-emerald-800">قائمة القراء</button>
                <button onclick="switchSection('mushaf')" class="text-right py-3">تصفح المصحف</button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-10 min-h-screen">
        <div id="mainLoader" class="flex flex-col items-center justify-center py-20">
            <div class="loader mb-4"></div>
            <p class="text-emerald-700 animate-pulse">جاري تحميل البيانات...</p>
        </div>

        <!-- Radios Section -->
        <section id="radios-section" class="hidden animate-in fade-in duration-700">
            <h2 class="text-3xl font-black text-emerald-900 mb-8 pr-4 border-r-4 border-amber-500">إذاعات القرآن المباشرة</h2>
            <div id="radiosGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
        </section>

        <!-- Reciters Section -->
        <section id="reciters-section" class="hidden animate-in fade-in duration-700">
            <div class="flex flex-col md:flex-row justify-between items-center gap-6 mb-10">
                <h2 class="text-3xl font-black text-emerald-900 pr-4 border-r-4 border-amber-500">أشهر القراء</h2>
                <div class="relative w-full md:w-96">
                    <input type="text" id="reciterSearch" onkeyup="filterReciters()" placeholder="ابحث عن قارئ..." 
                           class="w-full bg-white py-4 px-6 pr-14 rounded-2xl shadow-sm border-2 border-transparent focus:border-emerald-500 outline-none transition-all">
                    <i class="fa-solid fa-magnifying-glass absolute left-5 top-1/2 -translate-y-1/2 text-emerald-600"></i>
                </div>
            </div>
            <div id="recitersGrid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-6"></div>

            <!-- Surah Selection Overlay -->
            <div id="surahOverlay" class="hidden mt-12 bg-white rounded-[2rem] p-8 shadow-2xl border border-emerald-50 animate-in slide-in-from-bottom duration-500">
                <div class="flex justify-between items-center mb-8 border-b border-slate-100 pb-6">
                    <div>
                        <p class="text-emerald-600 font-bold text-sm mb-1 uppercase tracking-tighter">قائمة السور للقارئ:</p>
                        <h3 id="currentReciterName" class="text-3xl font-black text-slate-800"></h3>
                    </div>
                    <button onclick="closeSurahs()" class="bg-red-50 text-red-500 w-12 h-12 rounded-full hover:bg-red-500 hover:text-white transition-all">
                        <i class="fa-solid fa-xmark text-xl"></i>
                    </button>
                </div>
                <div id="surahsGrid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4"></div>
            </div>
        </section>

        <!-- Mushaf Section -->
        <section id="mushaf-section" class="hidden animate-in fade-in duration-700">
            <div class="bg-white rounded-[2rem] overflow-hidden shadow-2xl border border-emerald-100 h-[80vh]">
                <iframe src="https://quran.com/page/1" class="w-full h-full border-0" title="Quran Reader"></iframe>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container mx-auto">
            <p class="text-lg font-bold">©Sar7an_1(2026)</p>
            <p class="text-emerald-200 text-sm mt-2 font-light">تم التطوير لخدمة كتاب الله ونشره</p>
        </div>
    </footer>

    <!-- Fixed Audio Player -->
    <div class="fixed bottom-0 left-0 right-0 glass-nav text-white border-t border-emerald-800 p-4 z-[100] shadow-2xl" id="globalPlayer">
        <div class="container mx-auto flex flex-col md:flex-row items-center gap-6">
            
            <div class="flex items-center gap-4 w-full md:w-1/3">
                <div class="w-16 h-16 bg-amber-400 text-emerald-950 rounded-2xl flex items-center justify-center shadow-lg" id="playerArt">
                    <i class="fa-solid fa-microphone-lines text-2xl"></i>
                </div>
                <div class="min-w-0">
                    <h4 id="displayTitle" class="font-black truncate text-lg">لم يتم الاختيار</h4>
                    <p id="displaySubtitle" class="text-xs text-emerald-200 opacity-80 truncate">اختر مادة للتشغيل</p>
                </div>
            </div>

            <div class="flex flex-col items-center flex-1 w-full gap-2">
                <div class="flex items-center gap-10">
                    <button onclick="seekAudio(-10)" class="text-emerald-200 hover:text-amber-400 transition-all">
                        <i class="fa-solid fa-rotate-right text-xl"></i>
                    </button>
                    <button id="mainPlayBtn" onclick="togglePlayback()" class="w-16 h-16 bg-amber-500 text-emerald-950 rounded-full flex items-center justify-center shadow-xl hover:scale-110 active:scale-95 transition-all">
                        <i class="fa-solid fa-play text-2xl ml-1"></i>
                    </button>
                    <button onclick="seekAudio(10)" class="text-emerald-200 hover:text-amber-400 transition-all">
                        <i class="fa-solid fa-rotate-left text-xl"></i>
                    </button>
                </div>
                <div class="w-full flex items-center gap-4">
                    <span id="curTime" class="text-[10px] font-bold text-emerald-300 w-10">00:00</span>
                    <input type="range" id="audioRange" value="0" class="flex-1 h-1.5 rounded-full cursor-pointer accent-amber-400">
                    <span id="durTime" class="text-[10px] font-bold text-emerald-300 w-10">00:00</span>
                </div>
            </div>

            <div class="hidden md:flex items-center gap-4 w-1/4 justify-end">
                <i class="fa-solid fa-volume-high text-emerald-300"></i>
                <input type="range" id="volRange" min="0" max="1" step="0.1" value="1" class="w-24 h-1.5 accent-amber-400">
            </div>
        </div>
        <audio id="mainAudioElement"></audio>
    </div>

    <script>
        const audio = document.getElementById('mainAudioElement');
        const playBtn = document.getElementById('mainPlayBtn');
        const audioRange = document.getElementById('audioRange');
        const volRange = document.getElementById('volRange');
        
        let allReciters = [];
        let surahNames = ["الفاتحة", "البقرة", "آل عمران", "النساء", "المائدة", "الأنعام", "الأعراف", "الأنفال", "التوبة", "يونس", "هود", "يوسف", "الرعد", "إبراهيم", "الحجر", "النحل", "الإسراء", "الكهف", "مريم", "طه", "الأنبياء", "الحج", "المؤمنون", "النور", "الفرقان", "الشعراء", "النمل", "القصص", "العنكبوت", "الروم", "لقمان", "السجدة", "الأحزاب", "سبأ", "فاطر", "يس", "الصافات", "ص", "الزمر", "غافر", "فصلت", "الشورى", "الزخرف", "الدخان", "الجاثية", "الأحقاف", "محمد", "الفتح", "الحجرات", "ق", "الذاريات", "الطور", "النجم", "القمر", "الرحمن", "الواقعة", "الحديد", "المجادلة", "الحشر", "الممتحنة", "الصف", "الجمعة", "المنافقون", "التغابن", "الطلاق", "التحريم", "الملك", "القلم", "الحاقة", "المعارج", "نوح", "الجن", "المزمل", "المدثر", "القيامة", "الإنسان", "المرسلات", "النبأ", "النازعات", "عبس", "التكوير", "الإنفطار", "المطففين", "الإنشقاق", "البروج", "الطارق", "الأعلى", "الغاشية", "الفجر", "البلد", "الشمس", "الليل", "الضحى", "الشرح", "التين", "العلق", "القدر", "البينة", "الزلزلة", "العاديات", "القارعة", "التكاثر", "العصر", "الهمزة", "الفيل", "قريش", "الماعون", "الكوثر", "الكافرون", "النصر", "المسد", "الإخلاص", "الفلق", "الناس"];

        window.onload = () => {
            fetchRadios();
            fetchReciters();
            switchSection('radios');
            audio.ontimeupdate = updateProgress;
            audio.onended = () => playBtn.innerHTML = '<i class="fa-solid fa-play ml-1"></i>';
            audioRange.oninput = () => audio.currentTime = (audioRange.value / 100) * audio.duration;
            volRange.oninput = () => audio.volume = volRange.value;
        };

        function switchSection(id) {
            ['radios', 'reciters', 'mushaf'].forEach(s => {
                document.getElementById(`${s}-section`).classList.add('hidden');
                document.querySelector(`[data-target="${s}"]`).classList.remove('active-tab');
            });
            document.getElementById(`${id}-section`).classList.remove('hidden');
            document.querySelector(`[data-target="${id}"]`).classList.add('active-tab');
            document.getElementById('mobileMenu').classList.add('hidden');
        }

        function toggleMobileMenu() {
            document.getElementById('mobileMenu').classList.toggle('hidden');
        }

        async function fetchRadios() {
            try {
                const res = await fetch('https://mp3quran.net/api/v3/radios?language=ar');
                const data = await res.json();
                const grid = document.getElementById('radiosGrid');
                grid.innerHTML = data.radios.map(radio => `
                    <div class="bg-white p-6 rounded-[2rem] shadow-sm card-hover cursor-pointer border-b-4 border-emerald-500 flex items-center gap-4" 
                         onclick="playContent('${radio.url}', '${radio.name}', 'بث مباشر - إذاعة')">
                        <div class="bg-emerald-100 text-emerald-700 w-14 h-14 rounded-2xl flex items-center justify-center">
                            <i class="fa-solid fa-tower-broadcast text-xl"></i>
                        </div>
                        <h3 class="font-bold text-slate-800 text-sm leading-tight">${radio.name}</h3>
                    </div>
                `).join('');
                document.getElementById('mainLoader').classList.add('hidden');
            } catch (err) { console.error(err); }
        }

        async function fetchReciters() {
            try {
                const res = await fetch('https://www.mp3quran.net/api/v3/reciters?language=ar');
                const data = await res.json();
                allReciters = data.reciters;
                renderReciters(allReciters.slice(0, 100));
            } catch (err) { console.error(err); }
        }

        function renderReciters(list) {
            const grid = document.getElementById('recitersGrid');
            grid.innerHTML = list.map(r => `
                <div class="bg-white p-6 rounded-[2rem] shadow-sm card-hover cursor-pointer text-center group border border-transparent hover:border-emerald-200" 
                     onclick="openSurahList('${r.id}')">
                    <div class="w-16 h-16 bg-slate-100 rounded-full mx-auto flex items-center justify-center mb-4 group-hover:bg-emerald-600 transition-all">
                        <i class="fa-solid fa-user text-slate-400 group-hover:text-white text-xl"></i>
                    </div>
                    <h3 class="font-bold text-xs text-slate-700 truncate">${r.name}</h3>
                </div>
            `).join('');
        }

        function filterReciters() {
            const val = document.getElementById('reciterSearch').value.toLowerCase();
            const filtered = allReciters.filter(r => r.name.toLowerCase().includes(val));
            renderReciters(filtered.slice(0, 100));
        }

        function openSurahList(id) {
            const r = allReciters.find(x => x.id == id);
            const moshaf = r.moshaf[0];
            document.getElementById('currentReciterName').innerText = r.name;
            const grid = document.getElementById('surahsGrid');
            grid.innerHTML = moshaf.surah_list.split(',').map(sId => {
                const name = surahNames[parseInt(sId)-1];
                const fileUrl = `${moshaf.server}${sId.padStart(3, '0')}.mp3`;
                return `<button onclick="playContent('${fileUrl}', 'سورة ${name}', '${r.name}')" class="p-4 bg-emerald-50 text-emerald-900 rounded-2xl font-bold text-sm hover:bg-emerald-600 hover:text-white transition-all text-right quran-font">${name}</button>`;
            }).join('');
            document.getElementById('surahOverlay').classList.remove('hidden');
            document.getElementById('surahOverlay').scrollIntoView({ behavior: 'smooth' });
        }

        function closeSurahs() { document.getElementById('surahOverlay').classList.add('hidden'); }

        function playContent(url, title, artist) {
            audio.src = url;
            document.getElementById('displayTitle').innerText = title;
            document.getElementById('displaySubtitle').innerText = artist;
            audio.play();
            playBtn.innerHTML = '<i class="fa-solid fa-pause text-2xl"></i>';
        }

        function togglePlayback() {
            if(!audio.src) return;
            if(audio.paused) { audio.play(); playBtn.innerHTML = '<i class="fa-solid fa-pause text-2xl"></i>'; }
            else { audio.pause(); playBtn.innerHTML = '<i class="fa-solid fa-play text-2xl ml-1"></i>'; }
        }

        function seekAudio(val) { audio.currentTime += val; }

        function updateProgress() {
            if(isNaN(audio.duration)) { document.getElementById('curTime').innerText = "LIVE"; audioRange.value = 100; return; }
            audioRange.value = (audio.currentTime / audio.duration) * 100;
            document.getElementById('curTime').innerText = formatTime(audio.currentTime);
            document.getElementById('durTime').innerText = formatTime(audio.duration);
        }

        function formatTime(sec) {
            const m = Math.floor(sec / 60);
            const s = Math.floor(sec % 60);
            return `${m}:${s < 10 ? '0' : ''}${s}`;
        }
    </script>
</body>
</html>
